<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./product.css">
    <title>Document</title>
</head>
<body>
    <button class="back-home">
        <a href="/index.html">
            Back
        </a>
    </button>
    <section class="product"></section>
    <script>
         const url = 'https://course-api.com/javascript-store-single-product'
         const product = document.querySelector('.product')

         const fetchProduct = async () => {
            try {
                product.innerHTML = '<h4 class="product-loading">Loading... </h4>';
                // console.log(window.location.search);
                const params = new URLSearchParams(window.location.search);
                const id = params.get('id');

                const response = await fetch(`${url}?id=${id}`);
                const data = await response.json();
                return data;
            } catch (error) {
                productDOM.innerHTML =
                '<p class="error">There was a problem loading the product. Please try again later </p>';
            }
            };

         const displayProduct = (product) => {
            // company, colors, description, name:title, price, image(url:img)
            const {
                company,
                colors,
                description,
                name: title,
                price,
                image,
            } = product.fields;
            const { url: img } = image[0];
            document.title = title.toUpperCase();

            // colors
            const colorsList = colors
                .map((color) => {
                return `<span class="product-color" style="background: ${color}"></span>`;
                })
                .join('');

            product.innerHTML = `<div class="product-wrapper">
                    <img src="${img}" class="img" alt="${title}" />
                    <div class="product-info">
                    <h3>${title}</h3>
                    <h5>${company}</h5>
                    <span>${price / 100}</span>
                    <div class="colors">
                        ${colorsList}
                        
                    </div>
                    <p>
                    ${description}
                    </p>
                    <button class="btn">add to cart</button>
                    </div>
                </div>`;
            };

            const start = async () => {
            const data = await fetchProduct();
            displayProduct(data);
            };

            start();

    </script>
</body>
</html>